# GoDiemBFT

This is an implementation of DiemBFT- the consensus algorithm that underlies Facebook's Diem cryptocurrency, in Go.

## Note:

This project is a work in progress. As of now, it is a minimal working example of the algorithm. The transactions are not submitted by clients, but are rather generated by round leaders on the fly and have format "Validator\_(Validator ID) (Round)". Also, validators sleep for a brief period before proposing a new block so that the ledger does not grow too rapidly. To see it running, first do
`make all`
and then
`bash test.sh`
This will start up the test script which creates four diem replicas (validators). One is the cluster master and is in charge of setting up the cluster. The other nodes connect to the master in order to join the cluster. Once the master connects to 3\*f + 1 nodes, it sends configuration messages back to all the nodes and signals that they can start the DiemBFT algorithm. The script lets the validators run for about 5 seconds and then terminates them. The output can be seen in the generated log and ledger files.

Previously I had been part of a group that implemented the algorithm in Python+[DistAlgo](http://distalgo.cs.stonybrook.edu/)(A high level language for building distributed systems). DistAlgo makes it easy to spawn nodes in a distributed system and do common actions like sending messages, implementing receive handlers, and controlling synchronization in your program. Given Go's immense popularity in the realm of building highly scalable distributed systems, I decided to try implementing the algorithm in Go. Along the way, I've learned a lot about the language and just why it is so powerful for distributed systems.

## Design Decisions

- I decided to use to use gRPC with protocol buffers for communication between the Diem nodes (validators). gRPC makes it easy to perform RPC, and protocol buffers efficiently serialize structured data for sending over the wire. Additionally, they allow you to construct different modules of your distributed system in different languages and have them intercommunicate easily (ex: Your "replicas" can be implemented in Go and your clients can be implemented in Python,C++,etc. and they can perform RPC and send messages efficiently between each other).

## Coming Soon(ish)

- High level overview of the algorithm. For now, please check out the paper [DiemBFT v4: State Machine Replication in the Diem Blockchain](https://developers.diem.com/papers/diem-consensus-state-machine-replication-in-the-diem-blockchain/2021-08-17.pdf)
- A Diem Client to allow for submitting user transactions to the validators' MemPools, as well as a way to send replies to clients
- MemPool implementation, including a way to de-duplicate client requests
- Sync up: a method for validators that have fallen behind to catch up (learn about committed and proposed blocks)
- Comparison between Golang and Python+DistAlgo implementation of DiemBFT
